# <center> **Проект. Умный городской гид**

# <center> **"Музейный гид в Telegram: персонализация экскурсий"**

*Команда № 16: (Науки о данных)*


Группа 292406-3; SF - TGUDS-1

## 1. Описание задачи:

*Проблема:* Крупные музеи обладают большими коллециями и значительными экспозиционными площадями. На знакомство с ними можно потратить много часов, а то и дней. Не всегда турист знает, какой экспонат или зал будет для него наиболее привлекателен. Обладая малым временем на осмотр экспозиции, посетитель может упустить из виду то, что может быть для него действительно интересно. В следствие этого, он может уйти с плохим впечатлением от музея и с мыслью, что зря потратил деньги.

>*Бизнес-задача:* 1. Улучшить впечатления посетителя от музея.
                 2. Привлечь одиночных туристов с ограниченным временем.
                 3. Добавить интерактивности в знакомство с музеем.
                 Следовательно: увеличить количество посетителей, увеличить прибыль.

>*Техническая задача:* Разработать рекомендательную систему, которая сможет построить индивидуальный экскурсионный маршрут, основываясь на предпочтениях посетителя. Модель имплементировать в Telegram-бот.

## 2. Данные

Исходный набор представляет собой открытые данные [Государственного каталога музейного фонда РФ Министерства культуры РФ](https://opendata.mkrf.ru/opendata/7705851331-museum-exhibits). Содержит 39 624 705 записей, описанных 49 признаками. Общий объем 35.2 Гб.

Критерии выборки данных:

+ Музей, специализирующися на собрании живописи -> известные произведения, профессиональная атрибуция (описание, датировка, определение авторства)
+ Отбираем предметы, в которых заполнен признак "Описание" (важно для подбора ключевых слов)
+ Количество записей, достаточное для обучения ML-модели

Вывод: отбираем записи, относящиеся к экспонатам Государственного Русского музея - 57 254 записи.

Обработка данных:
+ удалены неинформативные признаки
+ очистка от пропусков
+ даты создания произведения преобразованы в категориальный признак
+ выделены ключевые слова на основе TF-IDF
+ отобраны типы экспонатов: живопись / графика


## 3. Рекомендательная система

[EDA.ipynb](Model/EDAfinal.ipynb)

### 3.1. Векторизация с применением RuBERT

Для получения эмбеддингов ключевых слов применен [DeepPavlov RuBERT base cased](https://huggingface.co/DeepPavlov/rubert-base-cased). В итоге получили датасет размерностью (35707, 768).

### 3.2. Кластеризация KMeans

Датасет разбит на 20 кластеров.

![image](https://github.com/user-attachments/assets/b26b27d4-d42a-4006-9c89-304498cb3f51)

### 3.3. Рекомендательная система на основе KMeans + KNN

Модель предлагает список из 5 рекомендаций на сонове предпочтений пользователя. В качестве меры схожести векторов использовано косинусное расстояние. 

## 4. Итог:

Подготовлен базовый образец телеграм бота с рекомендательной системой, который на основе интересов посетителя музея рекомендует 5 вариантов картин в экспозиции.

![image_2025-02-07_23-37-55](https://github.com/user-attachments/assets/1d5cfd79-6bdb-4983-bfc0-1009f58e2dba)

## Реализация проекта
**Стек технологий**:  
- Python
- PostgreSQL
- aiogram
- SqlAlchimy

## 5. Инструкция для запуска телеграм-бота

5.1. Установка виртуального окружения
+ Создание виртуального окружения для проекта
```python
python -m venv venv
```
+  Активировать виртуальное окружение Для Windows
```python
venv\Scripts\activate
```
+ Активировать виртуальное окружение Для Linux
```python
source venv/bin/activate
```
+ Отключить виртуальное окружение
```python
deactivate
```
5.2. Установка зависимостей
```python
pip install -r requirements.txt
```

5.3. Настройка переменных окружения

В корневой директории проекта создать ```.env``` файл, в котором будут храниться переменные окружения. 

Файл необходимо заполнить переменными, которые указаны в файле ```.env.example```.

5.4. Настройка миграций

+ Создается папка migrations и файл alembic.ini. В терминале:
```python
alembic init migrations
```
+ Генерация миграции
```python
alembic revision --autogenerate -m "Create users table"
```
+ Применение миграции
```python
alembic upgrade head
```
+ Откатить миграцию
```python
alembic downgrade -1
```
+ Смотреть состояние миграции
```python
alembic current
```
5.5. Запуск бота
```python
python -m main
```

## 6. Ссылки на библиотеки

+ [numpy](https://numpy.org/)
+ [pandas](https://pandas.pydata.org/)
+ [tqdm](https://tqdm.github.io/)
+ [spacy](https://spacy.io/)
+ [scikit-learn](https://scikit-learn.org/stable/)
+ [torch](https://pytorch.org/) 
+ [transformers](https://pypi.org/project/transformers/)
+ [pyarrow](https://arrow.apache.org/docs/python/index.html)
+ [sqlalchemy](https://www.sqlalchemy.org/)
+ [dotenv](https://www.npmjs.com/package/dotenv)
+ [psycopg2](https://pypi.org/project/psycopg2/)
+ [asyncio](https://pypi.org/project/asyncio/)
+ [aiogram](https://docs.aiogram.dev/en/v3.17.0/)

  ## 7. Возможности развития проекта
1. Пополнение базы экспонатов:
    - больше экспонатов и музеев
    
2. Расширение функционала бота для удобства туристов:
    - подгружать фото картин
    - отображать информацию месторасположении рекомендованных картин
    - добавить обратныю связь от пользователей после получения рекомендаций
    - добавить возможность запроса пользователем краткого описания о выбранных картинах
   - добавить поиск по авторам
